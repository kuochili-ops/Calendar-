<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>美女月曆 A4 直式</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 20px;
    }

    .controls {
      text-align: center;
      margin-bottom: 20px;
    }

    .controls select, .controls input, .controls button {
      margin: 5px;
      padding: 8px 12px;
      font-size: 1rem;
    }

    .calendar-output {
      width: 210mm;   /* A4 寬度 */
      max-width: 100%;
      margin: 0 auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .photo-preview img {
      width: 100%;
      max-height: 280mm; /* 上半部圖片 */
      object-fit: cover;
      border-radius: 8px 8px 0 0;
    }

    .calendar-grid {
      width: 100%;
      padding: 20px;
    }

    .calendar-grid h2 {
      text-align: center;
      margin: 0 0 10px;
      font-size: 2rem;
      color: #2c3e50;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      border-top: 1px solid #ccc;
      border-left: 1px solid #ccc;
    }

    .cell {
      min-height: 60px;
      border-right: 1px solid #ccc;
      border-bottom: 1px solid #ccc;
      padding: 6px;
      font-size: 1rem;
      position: relative;
    }

    .header-cell {
      background: #2c3e50;
      color: #fff;
      text-align: center;
      font-weight: bold;
      padding: 6px 0;
    }

    .cell.sunday, .cell.saturday {
      color: #e74c3c;
    }

    .holiday {
      font-size: 0.7rem;
      font-weight: bold;
      color: #27ae60;
      margin-top: 2px;
    }

    /* 列印設定：直式 A4，隱藏控制區 */
    @media print {
      .controls { display: none; }
      body { background: #fff; padding: 0; }
      .calendar-output {
        width: 210mm;
        height: 297mm; /* A4 高度 */
        box-shadow: none;
      }
      .photo-preview img {
        max-height: 50%; /* 上半部圖片 */
        border-radius: 0;
      }
      .calendar-grid {
        padding: 10mm;
      }
    }
  </style>
</head>
<body>

  <div class="controls">
    <input type="file" id="photoUpload" accept="image/*">
    <select id="yearSelect"></select>
    <select id="monthSelect"></select>
    <button onclick="generateCalendar()">產生月曆</button>
    <button onclick="exportCalendar()">匯出 PDF</button>
  </div>

  <div class="calendar-output">
    <div class="photo-preview">
      <img id="previewImage" src="" alt="預覽圖片">
    </div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </div>

  <script>
    const yearSelect = document.getElementById('yearSelect');
    const monthSelect = document.getElementById('monthSelect');
    const previewImage = document.getElementById('previewImage');

    // 填入年份選項
    for (let y = 2020; y <= 2030; y++) {
      const opt = document.createElement('option');
      opt.value = y;
      opt.textContent = y;
      yearSelect.appendChild(opt);
    }

    // 填入月份選項
    for (let m = 1; m <= 12; m++) {
      const opt = document.createElement('option');
      opt.value = m;
      opt.textContent = `${m} 月`;
      monthSelect.appendChild(opt);
    }

    // 圖片上傳預覽
    document.getElementById('photoUpload').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        previewImage.src = URL.createObjectURL(file);
      }
    });

    // 台灣常見國定假日（示範：部分假日）
    const holidays = {
      "2025-1-1": "元旦",
      "2025-2-28": "和平紀念日",
      "2025-4-4": "兒童節",
      "2025-4-5": "清明節",
      "2025-5-1": "勞動節",
      "2025-6-1": "端午節",
      "2025-9-28": "教師節",
      "2025-10-10": "國慶日",
      "2025-12-25": "聖誕節",
      "2025-12-31": "跨年夜"
    };

    function generateCalendar() {
      const year = parseInt(yearSelect.value);
      const month = parseInt(monthSelect.value);
      const grid = document.getElementById('calendarGrid');
      grid.innerHTML = '';

      const monthNames = ['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'];
      const title = document.createElement('h2');
      title.textContent = `${year}年 ${monthNames[month - 1]}`;
      grid.appendChild(title);

      const weekdays = ['日','一','二','三','四','五','六'];
      const headerRow = document.createElement('div');
      headerRow.className = 'grid';
      weekdays.forEach(day => {
        const cell = document.createElement('div');
        cell.className = 'header-cell';
        cell.textContent = day;
        headerRow.appendChild(cell);
      });
      grid.appendChild(headerRow);

      const firstDay = new Date(year, month - 1, 1).getDay();
      const daysInMonth = new Date(year, month, 0).getDate();
      const totalCells = Math.ceil((firstDay + daysInMonth) / 7) * 7;

      const calendarRow = document.createElement('div');
      calendarRow.className = 'grid';

      for (let i = 0; i < totalCells; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        if (i % 7 === 0) cell.classList.add('sunday');
        if (i % 7 === 6) cell.classList.add('saturday');

        const dayNum = i - firstDay + 1;
        if (dayNum > 0 && dayNum <= daysInMonth) {
          cell.textContent = dayNum;

          const dateStr = `${year}-${month}-${dayNum}`;
          if (holidays[dateStr]) {
            const holidayTag = document.createElement('div');
            holidayTag.className = 'holiday';
            holidayTag.textContent = holidays[dateStr];
            cell.appendChild(holidayTag);
          }
        }
        calendarRow.appendChild(cell);
      }

      grid.appendChild(calendarRow);
    }

    // 匯出 PDF（透過瀏覽器列印）
    function exportCalendar() {
      window.print();
    }
  </script>

</body>
</html>
