<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>美女月曆 A4 排版</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* 這裡放 CSS */
    body { font-family: 'Noto Sans TC', sans-serif; background: #f0f2f5; margin:0; padding:20px; }
    /* 其餘 CSS 同你原本的 */
  </style>
</head>
<body>

  <div class="controls">
    <input type="file" id="photoUpload" accept="image/*">
    <select id="yearSelect"></select>
    <select id="monthSelect"></select>
    <select id="layoutSelect">
      <option value="portrait">圖片直式</option>
      <option value="landscape">圖片橫式</option>
    </select>
    <select id="calendarLayout">
      <option value="vertical">月曆直式</option>
      <option value="horizontal">月曆橫式</option>
    </select>
    <button onclick="generateCalendar()">產生月曆</button>
    <button onclick="exportCalendar()">匯出 PDF</button>
  </div>

  <div class="calendar-output portrait vertical" id="calendarOutput">
    <div class="photo-preview">
      <img id="previewImage" src="IMG_5395.png" alt="預覽圖片">
    </div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </div>

  <script>
    // 這裡放 JavaScript
    const yearSelect = document.getElementById('yearSelect');
    const monthSelect = document.getElementById('monthSelect');
    const layoutSelect = document.getElementById('layoutSelect');
    const calendarLayout = document.getElementById('calendarLayout');
    const previewImage = document.getElementById('previewImage');
    const calendarOutput = document.getElementById('calendarOutput');

    for (let y = 2020; y <= 2030; y++) {
      const opt = document.createElement('option');
      opt.value = y;
      opt.textContent = y;
      yearSelect.appendChild(opt);
    }
    for (let m = 1; m <= 12; m++) {
      const opt = document.createElement('option');
      opt.value = m;
      opt.textContent = `${m} 月`;
      monthSelect.appendChild(opt);
    }
    yearSelect.value = 2025;
    monthSelect.value = 12;

    document.getElementById('photoUpload').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) previewImage.src = URL.createObjectURL(file);
    });

    layoutSelect.addEventListener('change', function() {
      calendarOutput.classList.remove('portrait', 'landscape');
      calendarOutput.classList.add(layoutSelect.value);
    });
    calendarLayout.addEventListener('change', function() {
      calendarOutput.classList.remove('vertical', 'horizontal');
      calendarOutput.classList.add(calendarLayout.value);
    });

    const holidays = { "2025-12-25": "聖誕節", "2025-12-31": "跨年夜" };

    function generateCalendar() {
      const year = parseInt(yearSelect.value);
      const month = parseInt(monthSelect.value);
      const grid = document.getElementById('calendarGrid');
      grid.innerHTML = '';

      const monthNames = ['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'];
      const title = document.createElement('h2');
      title.textContent = `${year}年 ${monthNames[month - 1]}`;
      grid.appendChild(title);

      const weekdays = ['日','一','二','三','四','五','六'];
      const headerRow = document.createElement('div');
      headerRow.className = 'grid';
      weekdays.forEach(day => {
        const cell = document.createElement('div');
        cell.className = 'header-cell';
        cell.textContent = day;
        headerRow.appendChild(cell);
      });
      grid.appendChild(headerRow);

      const firstDay = new Date(year, month - 1, 1).getDay();
      const daysInMonth = new Date(year, month, 0).getDate();
      const totalCells = Math.ceil((firstDay + daysInMonth) / 7) * 7;

      const calendarRow = document.createElement('div');
      calendarRow.className = 'grid';

      for (let i = 0; i < totalCells; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        if (i % 7 === 0) cell.classList.add('sunday');
        if (i % 7 === 6) cell.classList.add('saturday');

        const dayNum = i - firstDay + 1;
        if (dayNum > 0 && dayNum <= daysInMonth) {
          cell.textContent = dayNum;
          const dateStr = `${year}-${month}-${dayNum}`;
          if (holidays[dateStr]) {
            const holidayTag = document.createElement('div');
            holidayTag.className = 'holiday';
            holidayTag.textContent = holidays[dateStr];
            cell.appendChild(holidayTag);
          }
        }
        calendarRow.appendChild(cell);
      }
      grid.appendChild(calendarRow);
    }

    function exportCalendar() {
      window.print();
    }

    window.addEventListener('DOMContentLoaded', generateCalendar);
  </script>
</body>
</html>
